syntax = "proto3";

package aevatar.agents.ai.core;
option csharp_namespace = "Aevatar.Agents.AI.Core.Messages";

import "google/protobuf/timestamp.proto";
import "google/protobuf/any.proto";

// Note: Core types like AevatarAIProcessingMode, AevatarChatRole, AevatarChatMessage, 
// AevatarTokenUsage are defined in Aevatar.Agents.AI.Abstractions

// Import the shared types from AI.Abstractions
// However, proto imports work differently - we use C# for type sharing

// =====================================================
// Core Events for AI Agents
// =====================================================

// Chat request event
message ChatRequestEvent {
  string request_id = 1;
  string user_id = 2;
  string message = 3;
  map<string, string> context = 4;
  google.protobuf.Timestamp timestamp = 5;
  
  // Optional parameters
  double temperature = 6;
  int32 max_tokens = 7;
}

// Chat response event  
message ChatResponseEvent {
  string request_id = 1;
  string content = 2;
  int32 tokens_used = 3;
  int32 processing_mode = 4; // Maps to AevatarAIProcessingMode enum
  google.protobuf.Timestamp timestamp = 5;
  repeated ProcessingStep processing_steps = 6;
}

// =====================================================
// Processing Steps
// =====================================================

// Processing step for advanced reasoning
message ProcessingStep {
  ProcessingStepType type = 1;
  string description = 2;
  google.protobuf.Timestamp timestamp = 3;
  string result = 4;
  map<string, string> metadata = 5;
}

// Processing step type enumeration
enum ProcessingStepType {
  PROCESSING_STEP_TYPE_UNSPECIFIED = 0;
  PROCESSING_STEP_TYPE_PREPARATION = 1;
  PROCESSING_STEP_TYPE_LLM_GENERATION = 2;
  PROCESSING_STEP_TYPE_TOOL_EXECUTION = 3;
  PROCESSING_STEP_TYPE_REASONING = 4;
  PROCESSING_STEP_TYPE_ACTION = 5;
  PROCESSING_STEP_TYPE_OBSERVATION = 6;
  PROCESSING_STEP_TYPE_STRATEGY_SELECTION = 7;
}

// =====================================================
// Tool Execution Events
// =====================================================

// Tool executed event (published when a tool completes)
message AevatarToolExecutedEvent {
  string tool_name = 1;
  map<string, string> parameters = 2;
  string result = 3;
  bool success = 4;
  google.protobuf.Timestamp timestamp = 5;
  string agent_id = 6;
  int64 execution_time_ms = 7;
}

// Tool execution request event (for agent event handler)
message ToolExecutionRequestEvent {
  string request_id = 1;
  string tool_name = 2;
  string arguments = 3;
  google.protobuf.Timestamp timestamp = 4;
}

// Tool execution response event (for agent event handler)
message ToolExecutionResponseEvent {
  string request_id = 1;
  string tool_name = 2;
  bool success = 3;
  string result = 4;
  string error = 5;
  google.protobuf.Timestamp timestamp = 6;
}

// =====================================================
// Chat Role Enum (for local use without import)
// Using int32 for cross-proto compatibility
// =====================================================

// Maps to AevatarChatRole in AI.Abstractions
enum AevatarChatRole {
  UNSPECIFIED = 0;
  SYSTEM = 1;
  USER = 2;
  ASSISTANT = 3;
  FUNCTION = 4;
}

// Maps to AevatarAIProcessingMode in AI.Abstractions  
enum AevatarAIProcessingMode {
  STANDARD = 0;
  CHAIN_OF_THOUGHT = 1;
  REACT = 2;
  TREE_OF_THOUGHTS = 3;
}

// =====================================================
// Additional Event Types
// =====================================================

// Tree of Thoughts completed event
message AevatarTreeOfThoughtsCompletedEvent {
  string agent_id = 1;
  string thought_tree_id = 2;
  string selected_path = 3;
  double confidence = 4;
  google.protobuf.Timestamp timestamp = 5;
}

// AI Error event
message AevatarAIErrorEvent {
  string agent_id = 1;
  string error_type = 2;
  string error_message = 3;
  string context = 4;
  google.protobuf.Timestamp timestamp = 5;
}
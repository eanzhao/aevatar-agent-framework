# LlmTornado vs. Aevatar Agent Framework: æ·±åº¦å¯¹æ¯”åˆ†æž

æœ¬æ–‡æ¡£æ—¨åœ¨æ·±å…¥åˆ†æž [LlmTornado](https://github.com/lofcz/LlmTornado) åº“ï¼Œå¹¶å°†å…¶ä¸Žå½“å‰çš„ **Aevatar Agent Framework** è¿›è¡Œå¯¹æ¯”ï¼Œä»¥æ˜Žç¡®ä¸¤è€…çš„å®šä½å·®å¼‚ã€ä¼˜åŠ£åŠ¿åŠæ½œåœ¨çš„èžåˆç‚¹ã€‚

## 1. æ ¸å¿ƒå®šä½ä¸Žç›®æ ‡ (Core Purpose)

### LlmTornado ðŸŒªï¸
*   **å®šä½**: **LLM é›†æˆåº“ / SDK (Gateway)**ã€‚
*   **æ ¸å¿ƒç›®æ ‡**: æä¾›ä¸€ä¸ªç»Ÿä¸€ã€ç±»åž‹å®‰å…¨ä¸”ä¸Žä¾›åº”å•†æ— å…³ï¼ˆProvider-Agnosticï¼‰çš„ .NET æŽ¥å£ï¼Œç”¨äºŽè°ƒç”¨å„ç§ LLM APIï¼ˆOpenAI, Anthropic, Google, Ollama ç­‰ï¼‰ã€‚
*   **ç±»æ¯”**: å®ƒæ˜¯ LLM é¢†åŸŸçš„ "Super HttpClient" æˆ– "Dapper"ï¼Œä¸“æ³¨äºŽå¦‚ä½•æ›´æ–¹ä¾¿ã€æ›´å¼ºå¤§åœ°**è°ƒç”¨**æ¨¡åž‹ã€‚
*   **è®¾è®¡å“²å­¦**: "Low-level control with high-level convenience"ã€‚å®ƒä¸è¯•å›¾æŽ¥ç®¡æ•´ä¸ªåº”ç”¨æž¶æž„ï¼Œè€Œæ˜¯åšå¥½ "è°ƒç”¨æ¨¡åž‹" è¿™ä¸€ä»¶äº‹ã€‚

### Aevatar Agent Framework ðŸ¤–
*   **å®šä½**: **åˆ†å¸ƒå¼æ™ºèƒ½ä½“æ¡†æž¶ (Agent Framework)**ã€‚
*   **æ ¸å¿ƒç›®æ ‡**: æž„å»º**æœ‰çŠ¶æ€ (Stateful)**ã€**åˆ†å¸ƒå¼ (Distributed)**ã€**æŒä¹…åŒ– (Persistent)** çš„ AI æ™ºèƒ½ä½“ç³»ç»Ÿã€‚
*   **ç±»æ¯”**: å®ƒæ˜¯ AI é¢†åŸŸçš„ "Orleans" æˆ– "Akka"ï¼Œä¸“æ³¨äºŽæ™ºèƒ½ä½“çš„**ç”Ÿå‘½å‘¨æœŸ**ã€**çŠ¶æ€ç®¡ç†**å’Œ**å¹¶å‘æ¨¡åž‹**ã€‚
*   **è®¾è®¡å“²å­¦**: "State is King"ã€‚å¼ºè°ƒé€šè¿‡ Event Sourcing ä¿æŠ¤çŠ¶æ€ï¼Œé€šè¿‡ Actor æ¨¡åž‹å®žçŽ°é«˜å¹¶å‘ã€‚

---

## 2. æž¶æž„å¯¹æ¯” (Architecture)

| ç‰¹æ€§ | LlmTornado | Aevatar Agent Framework |
| :--- | :--- | :--- |
| **åŸºç¡€æž¶æž„** | åº“ (Library)ï¼Œæ— çŠ¶æ€ï¼Œéšç”¨éšè°ƒã€‚ | æ¡†æž¶ (Framework)ï¼ŒåŸºäºŽ Actor æ¨¡åž‹ (Orleans)ï¼Œæœ‰çŠ¶æ€ã€‚ |
| **LLM æŠ½è±¡å±‚** | è‡ªç ”ç»Ÿä¸€æŽ¥å£ (`LlmTornado.Chat`, `LlmTornado.Models`)ã€‚ | åŸºäºŽ **Microsoft.Extensions.AI (MEAI)** æ ‡å‡†ã€‚ |
| **çŠ¶æ€ç®¡ç†** | å¼±çŠ¶æ€ã€‚æä¾› `Conversation` ç±»ï¼Œä½†ä¸»è¦å­˜äºŽå†…å­˜ï¼Œä¸æ¶‰åŠæŒä¹…åŒ–æœºåˆ¶ã€‚ | **å¼ºçŠ¶æ€**ã€‚å†…ç½® Event Sourcing (`EventStore`), `StateProtectionContext`, `AevatarAIAgentState`ã€‚ |
| **å·¥å…·/å‡½æ•°è°ƒç”¨** | æ”¯æŒã€‚æä¾›åå°„æœºåˆ¶è‡ªåŠ¨æ³¨å†Œå·¥å…·ï¼Œæ”¯æŒ MCP (Model Context Protocol)ã€‚ | æ”¯æŒã€‚æä¾› `AevatarToolManager`, `ToolExecutionCoordinator`ï¼Œé›†æˆ MEAI `AITool`ã€‚ |
| **å¤šæ¨¡æ€** | å¼ºæ”¯æŒã€‚åŽŸç”Ÿæ”¯æŒå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘è¾“å…¥è¾“å‡ºã€‚ | æ”¯æŒã€‚ä¾èµ–äºŽ MEAI çš„å¤šæ¨¡æ€æ”¯æŒèƒ½åŠ›ã€‚ |
| **ç”Ÿæ€ä½** | **Consumer** (æ¶ˆè´¹è€…)ã€‚ä½œä¸ºåº”ç”¨çš„ä¸€éƒ¨åˆ†åŽ»æ¶ˆè´¹ LLM èƒ½åŠ›ã€‚ | **Host** (å®¿ä¸»)ã€‚ä½œä¸ºæ™ºèƒ½ä½“çš„å®¿ä¸»çŽ¯å¢ƒï¼Œç®¡ç†æ™ºèƒ½ä½“çš„ç”Ÿè€ç—…æ­»ã€‚ |

---

## 3. å…³é”®ç‰¹æ€§æ·±åº¦è§£æž

### 3.1 LLM é›†æˆæ–¹å¼
*   **LlmTornado**: æœ€å¤§çš„å–ç‚¹æ˜¯ **Provider Agnostic**ã€‚ä½ åªéœ€è¦æ”¹é…ç½®ï¼Œå°±èƒ½ä»Ž GPT-4 åˆ‡æ¢åˆ° Claude 3.5 æˆ–æœ¬åœ° Ollamaï¼Œä¸”ä»£ç å‡ ä¹Žä¸ç”¨å˜ã€‚å®ƒå¤„ç†äº†ä¸åŒä¾›åº”å•† API çš„å·®å¼‚ï¼ˆå¦‚ Token è®¡ç®—ã€å‚æ•°å‘½åï¼‰ã€‚
*   **Aevatar**: é€‰æ‹©äº†æ‹¥æŠ±å¾®è½¯å®˜æ–¹æ ‡å‡† **Microsoft.Extensions.AI**ã€‚è¿™æ˜¯ä¸€ä¸ªæˆ˜ç•¥æ€§é€‰æ‹©ã€‚è™½ç„¶ç›®å‰ MEAI çš„ç”Ÿæ€å¯èƒ½ä¸å¦‚ LlmTornado çš„è‡ªç ”é€‚é…å™¨ä¸°å¯Œï¼Œä½†å®ƒæ˜¯ .NET çš„æœªæ¥æ ‡å‡†ã€‚
    *   *ä¼˜åŠ¿*: å…¼å®¹æ‰€æœ‰æ”¯æŒ MEAI çš„ç»„ä»¶ï¼ˆå¦‚ Semantic Kernel çš„æŸäº›éƒ¨åˆ†ï¼‰ã€‚
    *   *åŠ£åŠ¿*: å¯¹ç‰¹å®šéžæ ‡æ¨¡åž‹çš„æ”¯æŒå¯èƒ½ä¸å¦‚ LlmTornado çµæ´»ï¼ˆé™¤éžè‡ªå·±å†™ MEAI å®žçŽ°ï¼‰ã€‚

### 3.2 çŠ¶æ€ä¸Žè®°å¿†
*   **LlmTornado**: å…³æ³¨ "Context Window" å†…çš„çŠ¶æ€ã€‚å®ƒå¸®ä½ ç®¡ç†å¯¹è¯åŽ†å²ï¼ˆHistoryï¼‰ï¼Œç¡®ä¿ä¸è¶…è¿‡ Token é™åˆ¶ï¼Œä½†ä¸€æ—¦ç¨‹åºé‡å¯ï¼ŒçŠ¶æ€å°±æ²¡äº†ï¼ˆé™¤éžä½ è‡ªå·±å­˜åº“ï¼‰ã€‚
*   **Aevatar**: å…³æ³¨ "Persistent State"ã€‚æ™ºèƒ½ä½“çš„çŠ¶æ€ï¼ˆStateï¼‰æ˜¯æŒä¹…åŒ–çš„ï¼Œé€šè¿‡äº‹ä»¶æº¯æºï¼ˆEvent Sourcingï¼‰ä¿è¯ä¸€è‡´æ€§ã€‚å³ä½¿æœåŠ¡å™¨å®•æœºï¼Œæ™ºèƒ½ä½“å¤æ´»åŽçŠ¶æ€ä¾ç„¶å­˜åœ¨ã€‚è¿™æ˜¯æž„å»ºé•¿æœŸè¿è¡Œ Agent çš„åŸºçŸ³ã€‚

### 3.3 æ™ºèƒ½ä½“èƒ½åŠ› (Agentic Capabilities)
*   **LlmTornado**: æä¾›äº† `Orchestrator`, `Runner`, `Advancer` ç­‰æ¦‚å¿µï¼Œæ”¯æŒæž„å»ºå·¥ä½œæµã€‚ä½†è¿™äº›æ›´å¤šæ˜¯ "æµç¨‹ç¼–æŽ’" (Workflow Orchestration)ã€‚
*   **Aevatar**: æä¾›äº† `AIGAgentWithToolBase` è¿™æ ·çš„åŸºç±»ï¼Œå°† LLMã€å·¥å…·ã€åŽ†å²ã€çŠ¶æ€å°è£…åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚è¿™æ›´æŽ¥è¿‘ "è‡ªä¸»æ™ºèƒ½ä½“" (Autonomous Agent) çš„æ¦‚å¿µã€‚

---

## 4. æ€»ç»“ä¸Žå¯ç¤º

### Aevatar çš„ä¼˜åŠ¿
1.  **ä¼ä¸šçº§çŠ¶æ€ç®¡ç†**: Event Sourcing æ˜¯ LlmTornado å®Œå…¨ä¸å…·å¤‡çš„ã€‚å¯¹äºŽé‡‘èžã€æ¸¸æˆç­‰å¯¹çŠ¶æ€ä¸€è‡´æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼ŒAevatar æ˜¯å”¯ä¸€é€‰æ‹©ã€‚
2.  **æ ‡å‡†åŒ–**: ä½¿ç”¨ `Microsoft.Extensions.AI` ä½¿å¾— Aevatar ç«™åœ¨äº†å·¨äººçš„è‚©è†€ä¸Šï¼Œé¿å…äº†ç»´æŠ¤ç§æœ‰ API åè®®çš„è´Ÿæ‹…ã€‚
3.  **åˆ†å¸ƒå¼**: åŸºäºŽ Orleans çš„è®¾è®¡ä½¿å¾— Aevatar å¤©ç”Ÿå…·å¤‡åˆ†å¸ƒå¼ã€é«˜å¹¶å‘èƒ½åŠ›ã€‚

### LlmTornado çš„ä¼˜åŠ¿ (å€¼å¾— Aevatar å­¦ä¹ )
1.  **å¤šæ¨¡æ€ä½“éªŒ**: LlmTornado åœ¨å¤šæ¨¡æ€ï¼ˆå›¾ç‰‡/éŸ³é¢‘ï¼‰å¤„ç†ä¸Šéžå¸¸ä¸æ»‘ï¼ŒAPI è®¾è®¡å¾ˆå‹å¥½ã€‚Aevatar ç›®å‰ä¸»è¦å…³æ³¨æ–‡æœ¬ï¼Œå¯ä»¥å€Ÿé‰´å…¶å¤šæ¨¡æ€æŽ¥å£è®¾è®¡ã€‚
2.  **æœ¬åœ°æ¨¡åž‹æ”¯æŒ**: LlmTornado å¯¹ Ollama/LocalAI çš„æ”¯æŒæ˜¯ä¸€ç­‰å…¬æ°‘ã€‚Aevatar è™½ç„¶å¯ä»¥é€šè¿‡ MEAI å¯¹æŽ¥ Ollamaï¼Œä½†å¯èƒ½ç¼ºä¹é’ˆå¯¹æ€§çš„ä¼˜åŒ–ï¼ˆå¦‚æœ¬åœ°æ¨¡åž‹çš„ç‰¹æ®Š Prompt æ¨¡æ¿ï¼‰ã€‚
3.  **MCP æ”¯æŒ**: LlmTornado æ”¯æŒ **Model Context Protocol**ï¼Œè¿™æ˜¯ä¸€ä¸ªæ–°å…´çš„å·¥å…·äº’æ“ä½œæ ‡å‡†ã€‚Aevatar å¯ä»¥è€ƒè™‘åœ¨ `AevatarToolManager` ä¸­å¢žåŠ å¯¹ MCP çš„æ”¯æŒï¼Œä»Žè€Œçž¬é—´èŽ·å¾—æµ·é‡çŽ°æˆå·¥å…·ã€‚

### ç»“è®º
**LlmTornado ä¸æ˜¯ Aevatar çš„ç«žäº‰å¯¹æ‰‹ï¼Œè€Œæ˜¯æ½œåœ¨çš„äº’è¡¥è€…ã€‚**

*   å¦‚æžœä½ åªæ˜¯æƒ³åœ¨ .NET App é‡ŒåŠ ä¸€ä¸ª "èŠå¤©æœºå™¨äºº" åŠŸèƒ½ï¼Œç”¨ **LlmTornado**ã€‚
*   å¦‚æžœä½ è¦æž„å»ºä¸€ä¸ª "ç”± 1000 ä¸ª NPC ç»„æˆçš„è™šæ‹Ÿä¸–ç•Œ" æˆ– "å…¨è‡ªåŠ¨åŒ–çš„ä¼ä¸šä¸šåŠ¡åŠ©ç†é›†ç¾¤"ï¼Œç”¨ **Aevatar**ã€‚

**å»ºè®®**: Aevatar å¯ä»¥ç»§ç»­æ·±è€• Agent ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€ç®¡ç†ï¼Œè€Œåœ¨ LLM è°ƒç”¨å±‚é¢ï¼Œåšå®šè·Ÿéš `Microsoft.Extensions.AI` æ ‡å‡†ã€‚å¦‚æžœæœªæ¥éœ€è¦æ”¯æŒæŸäº› MEAI å°šæœªè¦†ç›–çš„å°ä¼—æ¨¡åž‹ï¼Œç”šè‡³å¯ä»¥è€ƒè™‘å°è£… LlmTornado ä½œä¸ºä¸€ä¸ª `IAevatarLLMProvider` çš„å®žçŽ°ã€‚

---

## 5. æ·±åº¦é›†æˆç­–ç•¥ï¼šAevatar.Agents.AI.LLMTornado

ç”¨æˆ·æå‡ºçš„ "åˆ›å»ºä¸€ä¸ª `Aevatar.Agents.AI.LLMTornado` é¡¹ç›®ä¸Ž `MEAI` å¹³è¡Œ" æ˜¯ä¸€ä¸ªéžå¸¸å…·æœ‰æˆ˜ç•¥ä»·å€¼çš„æž¶æž„å†³ç­–ã€‚

### 5.1 æž¶æž„å¯è¡Œæ€§
Aevatar çš„è®¾è®¡å·²ç»é€šè¿‡ `IAevatarLLMProvider` æŽ¥å£è§£è€¦äº†å…·ä½“çš„ LLM å®žçŽ°ã€‚
*   **çŽ°çŠ¶**: `Aevatar.Agents.AI.MEAI` é¡¹ç›®å®žçŽ°äº† `IAevatarLLMProvider`ï¼Œåº•å±‚ä½¿ç”¨ `Microsoft.Extensions.AI`ã€‚
*   **æ‰©å±•**: å®Œå…¨å¯ä»¥åˆ›å»º `Aevatar.Agents.AI.LLMTornado` é¡¹ç›®ï¼ŒåŒæ ·å®žçŽ° `IAevatarLLMProvider`ï¼Œä½†åº•å±‚ä½¿ç”¨ `LlmTornado`ã€‚
*   **å…±å­˜**: å¼€å‘è€…å¯ä»¥åœ¨ `Program.cs` ä¸­é€šè¿‡ä¾èµ–æ³¨å…¥è‡ªç”±é€‰æ‹©ä½¿ç”¨ MEAI è¿˜æ˜¯ LLMTornadoï¼Œç”šè‡³åœ¨åŒä¸€ä¸ªç³»ç»Ÿä¸­æ··ç”¨ï¼ˆä¾‹å¦‚ Agent A ç”¨ MEAI è°ƒ OpenAIï¼ŒAgent B ç”¨ LLMTornado è°ƒ Claudeï¼‰ã€‚

### 5.2 é›†æˆ LLMTornado å¸¦æ¥çš„é¢å¤–ä»·å€¼ (Beyond More Models)

é™¤äº† "èƒ½è°ƒç”¨æ›´å¤šæ¨¡åž‹" ä¹‹å¤–ï¼Œé›†æˆ LLMTornado è¿˜èƒ½ä¸º Aevatar å¸¦æ¥ä»¥ä¸‹æ ¸å¿ƒ Featureï¼š

#### 1. å¼€ç®±å³ç”¨çš„ MCP (Model Context Protocol) æ”¯æŒ ðŸ”Œ
*   **ç—›ç‚¹**: MEAI ç›®å‰å¯¹ MCP çš„æ”¯æŒè¿˜åœ¨æ—©æœŸé˜¶æ®µï¼Œå¯èƒ½éœ€è¦è‡ªå·±å†™é€‚é…å™¨ã€‚
*   **ä»·å€¼**: LlmTornado åŽŸç”Ÿæ”¯æŒ MCPã€‚è¿™æ„å‘³ç€ Aevatar å¯ä»¥é€šè¿‡å®ƒç›´æŽ¥è¿žæŽ¥åˆ° GitHub, Google Drive, Slack ç­‰æ”¯æŒ MCP çš„æ•°æ®æºå’Œå·¥å…·ï¼Œçž¬é—´æžå¤§åœ°ä¸°å¯Œ Agent çš„å·¥å…·ç®±ï¼Œè€Œæ— éœ€è‡ªå·±ä¸ºæ¯ä¸ªæœåŠ¡å†™ Toolã€‚

#### 2. å¢žå¼ºçš„é²æ£’æ€§ä¸Ž fallback æœºåˆ¶ ðŸ›¡ï¸
*   **ç—›ç‚¹**: MEAI ä¸»è¦æ˜¯æŽ¥å£æ ‡å‡†ï¼Œé‡è¯•ã€é™çº§ã€Fallback é€»è¾‘é€šå¸¸éœ€è¦ç”±å…·ä½“çš„å®žçŽ°åº“ï¼ˆå¦‚ Semantic Kernelï¼‰æˆ–å¼€å‘è€…è‡ªå·±å¤„ç†ã€‚
*   **ä»·å€¼**: LlmTornado ä½œä¸ºä¸€ä¸ª "Gateway" é£Žæ ¼çš„åº“ï¼Œå†…ç½®äº†æ›´å¼ºçš„ API å®¹é”™å¤„ç†ã€‚å®ƒå¯ä»¥è‡ªåŠ¨å¤„ç†ä¸åŒä¾›åº”å•†çš„å‚æ•°å·®å¼‚ï¼ˆParameter Normalizationï¼‰ï¼Œå¹¶å¯èƒ½æä¾›æ›´æ–¹ä¾¿çš„ Provider Fallbackï¼ˆä¾‹å¦‚ OpenAI æŒ‚äº†è‡ªåŠ¨åˆ‡ Azureï¼‰ã€‚

#### 3. æ›´ä¸æ»‘çš„æœ¬åœ°æ¨¡åž‹ä½“éªŒ (Local LLM First) ðŸ 
*   **ç—›ç‚¹**: è™½ç„¶ MEAI å¯ä»¥æŽ¥ Ollamaï¼Œä½†å¾€å¾€éœ€è¦é…ç½®é€šç”¨çš„ OpenAI å…¼å®¹ç«¯ç‚¹ï¼Œæœ‰æ—¶ä¼šé‡åˆ° Prompt æ ¼å¼ä¸å…¼å®¹çš„é—®é¢˜ã€‚
*   **ä»·å€¼**: LlmTornado å¯¹ Ollama, vLLM, LocalAI æœ‰ä¸€ç­‰å…¬æ°‘çš„æ”¯æŒï¼Œå¯èƒ½å†…ç½®äº†é’ˆå¯¹è¿™äº›æœ¬åœ°æŽ¨ç†å¼•æ“Žçš„ Prompt ä¼˜åŒ–å’Œå‚æ•°è°ƒæ•´ï¼Œè®©æœ¬åœ° Agent è·‘å¾—æ›´é¡ºç•…ã€‚

#### 4. ç»Ÿä¸€çš„å¤šæ¨¡æ€ API ðŸ–¼ï¸
*   **ç—›ç‚¹**: MEAI çš„å¤šæ¨¡æ€æ”¯æŒä¾èµ–äºŽå…·ä½“å®žçŽ°ï¼Œä¸åŒåº“çš„ API é£Žæ ¼å¯èƒ½ä¸åŒã€‚
*   **ä»·å€¼**: LlmTornado æä¾›äº†ä¸€å¥—ç»Ÿä¸€ã€å¼ºç±»åž‹çš„å¤šæ¨¡æ€ APIï¼ˆå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ï¼‰ã€‚å¯¹äºŽéœ€è¦é¢‘ç¹å¤„ç†å¤šåª’ä½“å†…å®¹çš„ Agentï¼Œä½¿ç”¨ LLMTornado çš„å°è£…å¯èƒ½æ¯”æ‰‹å†™ MEAI çš„å¤šæ¨¡æ€æž„é€ æ›´ç®€å•ç›´è§‚ã€‚

### 5.3 æŽ¨èè·¯çº¿å›¾
1.  **ä¿æŒ MEAI ä¸ºæ ¸å¿ƒ**: ç»§ç»­ä»¥ MEAI ä¸ºé»˜è®¤æŽ¨èï¼Œå› ä¸ºå®ƒæ˜¯ .NET ç”Ÿæ€çš„æ ‡å‡†ï¼Œå…¼å®¹æ€§æœ€å¥½ã€‚
2.  **å¼•å…¥ LLMTornado ä½œä¸ºæ‰©å±•åŒ…**: å‘å¸ƒ `Aevatar.Agents.AI.LLMTornado` NuGet åŒ…ã€‚
3.  **åœºæ™¯åŒ–æŽ¨è**:
    *   éœ€è¦ **Claude / Cohere / Groq** åŽŸç”Ÿæ”¯æŒ -> ç”¨ LLMTornadoã€‚
    *   éœ€è¦ **MCP å·¥å…·é“¾** -> ç”¨ LLMTornadoã€‚
    *   éœ€è¦ **æœ¬åœ°æ¨¡åž‹ (Ollama)** æ·±åº¦ä¼˜åŒ– -> å°è¯• LLMTornadoã€‚
    *   æ ‡å‡† **OpenAI / Azure** ä¸šåŠ¡ -> ç”¨ MEAIã€‚

